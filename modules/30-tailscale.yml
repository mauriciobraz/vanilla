name: tailscale
type: shell
commands:
  - apt-mark hold tailscale

modules:
  - name: tailscale-install
    type: apt
    sources:
      - packages:
          - tailscale

    modules:
      - name: tailscale-repo-setup
        type: shell
        commands:
          - curl -fsSL https://pkgs.tailscale.com/stable/debian/trixie.noarmor.gpg -o /usr/share/keyrings/tailscale-archive-keyring.gpg
          - curl -fsSL https://pkgs.tailscale.com/stable/debian/trixie.tailscale-keyring.list -o /etc/apt/sources.list.d/tailscale.list
          - apt-get update
